# CFBot Website - AI Agent Instructions

## Project Overview

This is a **React Router v7** + **Fumadocs** documentation website for CFBot, a Discord bot framework. The site features a marketing homepage and integrated documentation system with full-text search.

## Architecture

### Core Stack

- **React Router v7** (file-based routing with manual route config)
- **Fumadocs** (MDX-based documentation framework)
- **Vite** (build tool with TypeScript support)
- **Tailwind CSS v4** (utility-first styling)
- **Motion** (`motion/react`) for animations
- **Lenis** for smooth scrolling
- **Orama** for client-side search

### File Structure Pattern

```
app/
  ├── routes.ts              # Manual route definitions (not automatic)
  ├── root.tsx               # Root layout with RootProvider, ReactLenis
  ├── routes/                # Route components
  ├── pages/home/            # Page sections (hero, features, etc.)
  ├── docs/                  # Docs-specific components & API routes
  ├── lib/                   # Shared utilities & Fumadocs config
  └── components/            # App-specific components
components/                  # Shared components (outside app/)
content/docs/               # MDX documentation files
```

### Import Path Aliases

- `@/*` → `./app/*` (app directory)
- `components/*` → `./components/*` (shared components, no @ prefix)
- `fumadocs-mdx:collections/*` → `.source/*` (generated by Fumadocs)

**Critical:** Use `components/home-animate` NOT `@/components/home-animate` for shared components.

## Routing & Navigation

### Manual Route Configuration

Routes are **explicitly defined** in `app/routes.ts`, not auto-generated:

```typescript
export default [
  index("routes/home.tsx"),
  route("docs/*", "docs/page.tsx"), // Fumadocs catchall
  route("api/search", "docs/search.ts"), // Search API
] satisfies RouteConfig;
```

When adding routes, always update `routes.ts` manually.

### Pre-rendering Configuration

`react-router.config.ts` defines SSG behavior:

- `ssr: false` - Client-side only
- `prerender()` - Generates static HTML for all MDX docs

## Documentation System (Fumadocs)

### Content Flow

1. MDX files in `content/docs/` → Fumadocs processes via `source.config.ts`
2. Generated to `.source/` (git-ignored, referenced via `fumadocs-mdx:collections/*`)
3. `app/lib/source.ts` creates the source loader
4. `app/docs/page.tsx` renders docs with `clientLoader.createClientLoader()`

### Adding Documentation

1. Create `.mdx` file in `content/docs/`
2. Update `content/docs/meta.json` for sidebar ordering:
   ```json
   { "pages": ["index", "new-page", "..."] }
   ```
3. Run `pnpm postinstall` (or let build trigger it) to regenerate
4. No route changes needed (handled by `docs/*` catchall)

### Search Implementation

- **API Route:** `app/docs/search.ts` generates static search index via Orama
- **UI Component:** `app/components/search.tsx` uses `useDocsSearch` hook
- **Language:** Configured as "english" in both files (change together if needed)

## Styling Conventions

### Tailwind Usage

- **Prefix:** None (default, no `fuma-` prefix despite commented code in vite.config)
- **Theme:** Forced dark mode (`defaultTheme: "dark"`, `enableSystem: false` in root.tsx)
- **Class Utilities:** Use `cn()` from `@/lib/utils` for conditional classes

### Component Patterns

- **shadcn/ui:** Configured in `components.json`, components go to `@/components/ui/`
- **Custom Components:** Reusable UI in `components/`, page-specific in `app/pages/`
- **Icons:** Lucide React (e.g., `<Code />`, `<Play />`)

## Animation Patterns

### Motion Components

Use `motion` from `motion/react` (NOT framer-motion):

```tsx
import { motion } from "motion/react";

// Fade-in on scroll (used in hero sections)
<motion.div
  initial={{ opacity: 0, y: 30 }}
  whileInView={{ opacity: 1, y: 0 }}
  viewport={{ once: true }}
  transition={{ delay: 0.2 }}
>
```

See `components/home-animate.tsx` for reusable animation wrappers (`AnimatedTitle`, `HighlightedText`).

### Smooth Scrolling

`ReactLenis` is applied at root level - all page scrolling is automatically smooth.

## Development Workflow

### Commands (pnpm)

```bash
pnpm dev              # Start dev server (Vite + React Router)
pnpm build            # Production build (includes MDX processing)
pnpm start            # Serve production build
pnpm types:check      # Type-check + generate Fumadocs types
pnpm postinstall      # Regenerate MDX (auto-runs after install)
```

### Type Safety

- **React Router Types:** Use `Route.ComponentProps`, `Route.LoaderArgs` from `+types` files
- **Fumadocs Collections:** Import from `fumadocs-mdx:collections/browser` or `/server`
- Always run `types:check` before committing

### i18n Consideration

The UI is primarily **Traditional Chinese (zh-TW)** but search is configured for English. When adding UI text, follow existing Chinese conventions unless docs content is involved.

## Key Files to Reference

| File                        | Purpose                                 |
| --------------------------- | --------------------------------------- |
| `app/root.tsx`              | Global providers (theme, search, Lenis) |
| `app/lib/layout.shared.tsx` | Navbar configuration & logo component   |
| `app/docs/page.tsx`         | Fumadocs page rendering logic           |
| `source.config.ts`          | MDX collection definition               |
| `react-router.config.ts`    | SSG/prerendering rules                  |

## Common Pitfalls

1. **Import Errors:** Forgetting `@/` prefix for app files or using it for `components/`
2. **Route Changes:** Adding files without updating `app/routes.ts`
3. **MDX Not Found:** Forgetting to run `pnpm postinstall` after adding docs
4. **Motion vs Framer:** Using `framer-motion` instead of `motion/react`
5. **Search Language Mismatch:** Changing language in only one search file (sync both)

## External Resources

- Discord Bot Repo: https://github.com/510208/cfbot
- DeepWiki: https://deepwiki.com/510208/cfbot
- Fumadocs Docs: https://fumadocs.vercel.app
